{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/index.js","webpack:///./src/scripts/layer-hotkeys.js","webpack:///./src/scripts/settings-extender.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Hooks","once","async","CONFIG","layer","tool","DEFAULT_KEYS","token","measure","tiles","drawings","walls","lighting","sounds","notes","maxNumTools","control","ui","controls","visible","game","settings","register","title","hint","i18n","localize","scope","config","default","type","window","Azzu","SettingsTypes","KeyBinding","onChange","Math","max","tools","length","toString","on","app","html","data","find","ev","render","addEventListener","repeat","document","activeElement","tagName","parse","eventIsForBinding","preventDefault","stopPropagation","canvas","getLayer","activate","keyUpStopper","removeEventListener","useCapture","activeControl","e","filter","activateTool","ctrlKey","onClick","activeTool","activeLayer","preview","children","wall","wall_data","_getWallDataFromActiveTool","scene_control","layerKeys","undefined","entries","toolKeys","li","getAttribute","toUpperCase","ctrls","getElementsByClassName","j","SETTINGS_EXTENDER_VERSION","major","minor","patch","MODIFIERS","shiftKey","metaKey","altKey","parseModifiers","val","keyProp","reduce","obj","prop","includes","replace","formatModifiers","modifier","mod","str","binding","modifiers","keys","modifiersCorrect","modifiersEqual","originalEvent","IGNORED_KEYS","MouseButtonBinding","FilePickerImage","_MOUSE_BUTTONS","Proxy","0","1","2","_eventHandlers","$input","$","target","focus","format","test","button","btn","text","event","_LOCATIONS","3","withModifiers","entry","location","filePickers","FilePickerVideo","FilePickerImageVideo","FilePickerAudio","_init","$html","each","idx","input","parent","css","attr","substring","toLowerCase","$filePickerButton","after","values","forEach","FilePicker","DirPicker","options","super","this","extensions","activateListeners","remove","$li","$selectButton","_addOnClick","prepend","$selectCurrent","append","path","click","field","close","DirectoryPicker","$browseButton","current","browse","createExtraInputTypes","registerSettingsTypes","existingClass","ExtendedSettingsConfig","oldVersion","settingsExtenderVersion","curVersion","isNewestVersionEnabled","_sheet","Compatibility","below_0_5_3","between_0_5_3_and_0_6_0","Map","SettingsConfig","mergeObject","defaultOptions","baseApplication","getData","getSettingsConfigModules","flatMap","setting","getGameSettting","extraTypes","$inputs","eventType","handler"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"modules/layer-hotkeys/scripts/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/scripts/index.js\");\n","import Init from './layer-hotkeys.js';\nimport settingsExtender from './settings-extender.js';\n\nsettingsExtender();\nInit();","export default function () {\n  Hooks.once(\"ready\", async () => {\n    CONFIG[\"layer-hotkeys\"] = {\n      layer: {},\n      tool: {},\n    };\n    const DEFAULT_KEYS = {\n      token: \"t\",\n      measure: \"m\",\n      tiles: \"i\",\n      drawings: \"d\",\n      walls: \"w\",\n      lighting: \"l\",\n      sounds: \"s\",\n      notes: \"n\",\n    };\n\n    let maxNumTools = 0;\n    for (let control of ui.controls.controls) {\n      // Skip controls  that aren't accessible for the user\n      if (control.visible == false) continue;\n\n      game.settings.register(\"layer-hotkeys\", \"control-\" + control.name, {\n        name: control.title,\n        hint:\n          game.i18n.localize(\"LAYER-HOTKEYS.ControlsHint\") +\n          \" \" +\n          game.i18n.localize(control.title),\n        scope: \"user\",\n        config: true,\n        default: DEFAULT_KEYS[control.name] || null,\n        type: window.Azzu.SettingsTypes.KeyBinding,\n        onChange: (key) => {\n          CONFIG[\"layer-hotkeys\"].layer[control.name] = key;\n        },\n      });\n      CONFIG[\"layer-hotkeys\"].layer[control.name] = game.settings.get(\n        \"layer-hotkeys\",\n        \"control-\" + control.name\n      );\n      maxNumTools = Math.max(control.tools.length, maxNumTools);\n    }\n\n    for (let i = 1; i <= maxNumTools; i++) {\n      game.settings.register(\"layer-hotkeys\", \"tool-\" + i, {\n        name: game.i18n.localize(\"LAYER-HOTKEYS.ToolName\") + \" \" + i,\n        hint:\n          game.i18n.localize(\"LAYER-HOTKEYS.ToolsHint\") +\n          \" \" +\n          game.i18n.localize(\"LAYER-HOTKEYS.ToolName\") +\n          \" \" +\n          i,\n        scope: \"user\",\n        config: true,\n        default: (i % 10).toString() || \"0\",\n        type: window.Azzu.SettingsTypes.KeyBinding,\n        onChange: (key) => {\n          CONFIG[\"layer-hotkeys\"].tool[i] = key;\n        },\n      });\n      CONFIG[\"layer-hotkeys\"].tool[i] = game.settings.get(\n        \"layer-hotkeys\",\n        \"tool-\" + i\n      );\n    }\n  });\n\n  Hooks.on(\"renderExtendedSettingsConfig\", (app, html, data) => {\n    // Force rerender of controls on submitting settings, so the titles get updated\n    html.find(\"button:submit\").on(\"click\", (ev) => ui.controls.render());\n  });\n\n  Hooks.once(\"init\", () => {\n    window.addEventListener(\n      \"keydown\",\n      (ev) => {\n        if (ev.repeat) return true;\n\n        if (document.activeElement.tagName !== \"BODY\") return true;\n\n        for (let control of ui.controls.controls) {\n          // Skip controls  that aren't accessible for the user\n          if (control.visible == false) continue;\n\n          const key = window.Azzu.SettingsTypes.KeyBinding.parse(\n            CONFIG[\"layer-hotkeys\"].layer[control.name]\n          );\n          if (window.Azzu.SettingsTypes.KeyBinding.eventIsForBinding(ev, key)) {\n            ev.preventDefault();\n            ev.stopPropagation();\n            canvas.getLayer(control.layer).activate();\n\n            let keyUpStopper = (ev) => {\n              const key = window.Azzu.SettingsTypes.KeyBinding.parse(\n                CONFIG[\"layer-hotkeys\"].layer[control.name]\n              );\n              const isKey = window.Azzu.SettingsTypes.KeyBinding.eventIsForBinding(\n                ev,\n                key\n              );\n              if (isKey) {\n                ev.preventDefault();\n                ev.stopPropagation();\n                window.removeEventListener(\"keyup\", keyUpStopper);\n                return false;\n              }\n            };\n            window.addEventListener(\"keyup\", keyUpStopper, {\n              useCapture: true,\n            });\n\n            return false;\n          }\n        }\n\n        const activeControl = ui.controls.controls.find(\n          (e) => e.name === ui.controls.activeControl\n        );\n        const tools =\n          activeControl.tools.filter((e) => e.visible !== false) || [];\n        for (let i = 0; i < tools.length; i++) {\n          const key = window.Azzu.SettingsTypes.KeyBinding.parse(\n            CONFIG[\"layer-hotkeys\"].tool[i + 1]\n          );\n          let activateTool = window.Azzu.SettingsTypes.KeyBinding.eventIsForBinding(\n            ev,\n            key\n          );\n          //extra check for wall chaining\n          if (activeControl.name === \"walls\") {\n            key.ctrlKey = true;\n            activateTool =\n              activateTool ||\n              window.Azzu.SettingsTypes.KeyBinding.eventIsForBinding(ev, key);\n          }\n          if (activateTool) {\n            ev.preventDefault();\n            ev.stopPropagation();\n\n            if (tools[i].onClick) tools[i].onClick();\n            else {\n              activeControl.activeTool = tools[i].name;\n              ui.controls.render();\n            }\n            // Change preview color for walls when chaining walls\n            if (activeControl.name === \"walls\") {\n              let layer = canvas.activeLayer;\n              if (layer.preview.children[0]) {\n                let wall = layer.preview.children[0];\n                const wall_data = layer._getWallDataFromActiveTool(\n                  game.activeTool\n                );\n                let data = wall.data;\n                wall_data.c = data.c;\n                wall.data = wall_data;\n              }\n            }\n\n            let keyUpStopper = (ev) => {\n              const key = window.Azzu.SettingsTypes.KeyBinding.parse(\n                CONFIG[\"layer-hotkeys\"].tool[i + 1]\n              );\n              const isKey = window.Azzu.SettingsTypes.KeyBinding.eventIsForBinding(\n                ev,\n                key\n              );\n              if (isKey) {\n                ev.preventDefault();\n                ev.stopPropagation();\n                window.removeEventListener(keyUpStopper);\n                return false;\n              }\n            };\n            window.addEventListener(\"keyup\", keyUpStopper);\n\n            return false;\n          }\n        }\n        return true;\n      },\n      { useCapture: true }\n    );\n  });\n\n  Hooks.on(\"renderSceneControls\", (app, html, data) => {\n    let scene_control = html.children(\"li.scene-control\");\n    let layerKeys = {};\n    let config = CONFIG[\"layer-hotkeys\"];\n    if (config === undefined) return;\n\n    for (let [key, value] of Object.entries(config.layer))\n      layerKeys[value] = key;\n    let toolKeys = {};\n    for (let [key, value] of Object.entries(config.tool)) toolKeys[value] = key;\n\n    for (let i = 0; i < scene_control.length; i++) {\n      const li = scene_control[i];\n      let title = li.getAttribute(\"title\");\n      let key = config.layer[li.getAttribute(\"data-control\")];\n      if (key !== undefined) li.title += \" [\" + key.toUpperCase() + \"]\";\n      let ctrls = li.getElementsByClassName(\"control-tool\");\n      for (let j = 0; j < ctrls.length; j++) {\n        let title = ctrls[j].title + \" [\" + config.tool[j + 1] + \"]\";\n        ctrls[j].title = title;\n      }\n    }\n  });\n}\n","/**\n * window.Azzu.SettingsTypes is guaranteed to be initialized on document.ready\n * window.Azzu.ExtendedSettingsConfig is guaranteed to be initialized after Hooks->ready\n */\nexport default function () {\n\tconst SETTINGS_EXTENDER_VERSION = {\n\t\tmajor: 1,\n\t\tminor: 1,\n\t\tpatch: 3\n\t};\n\n\twindow.Azzu = window.Azzu || {};\n\tregisterSettingsTypes();\n\textendSettingsWindow();\n\n\t// Definitions\n\n\t/**\n\t * Collection of utility methods whose only purpose it is to maintain backwards compatibility.\n\t */\n\tclass Compatibility {\n\n\t\t/**\n\t\t * Compatibility for getting the modules list from SettingsConfig\n\t\t *\n\t\t * @param data SettingsConfig.getData() object\n\t\t * @returns data.settings.modules or data.modules\n\t\t */\n\t\tstatic getSettingsConfigModules(data) {\n\t\t\tconst below_0_5_3 = data.settings && data.settings.modules;\n\t\t\tconst between_0_5_3_and_0_6_0 = data.modules;\n\t\t\tconst above_0_6_1 = data.data && data.data.modules;\n\t\t\treturn above_0_6_1 || between_0_5_3_and_0_6_0 || below_0_5_3;\n\t\t}\n\n\t\t/**\n\t\t * Compatibility for <0.5.3\n\t\t *\n\t\t * @param key the key of the game setting\n\t\t * @returns the game setting object\n\t\t */\n\t\tstatic getGameSettting(key) {\n\t\t\tconst settings = game.settings.settings;\n\t\t\tif (settings instanceof Map) {\n\t\t\t\treturn settings.get(key);\n\t\t\t} else {\n\t\t\t\treturn settings[key];\n\t\t\t}\n\t\t}\n\t}\n\n\tfunction registerSettingsTypes() {\n\t\tif (window.Azzu.SettingsTypes) {\n\t\t\treturn;\n\t\t}\n\n\t\twindow.Azzu.SettingsTypes = createExtraInputTypes();\n\t}\n\n\tfunction createExtraInputTypes() {\n\t\tconst MODIFIERS = {\n\t\t\tctrlKey: 'Ctrl + ',\n\t\t\tshiftKey: 'Shift + ',\n\t\t\tmetaKey: 'Meta + ',\n\t\t\taltKey: 'Alt + '\n\t\t};\n\n\t\tfunction parseModifiers(val, keyProp) {\n\t\t\treturn Object.entries(MODIFIERS).reduce((obj, [prop, val]) => {\n\t\t\t\tif (obj[keyProp].includes(val)) {\n\t\t\t\t\tobj[prop] = true;\n\t\t\t\t\tobj[keyProp] = obj[keyProp].replace(val, '');\n\t\t\t\t} else {\n\t\t\t\t\tobj[prop] = false;\n\t\t\t\t}\n\t\t\t\treturn obj;\n\t\t\t}, {[keyProp]: val});\n\t\t}\n\n\t\tfunction formatModifiers(val) {\n\t\t\treturn Object.entries(MODIFIERS)\n\t\t\t\t.reduce((modifier, [mod, str]) => {\n\t\t\t\t\treturn modifier + (val[mod] ? str : '');\n\t\t\t\t}, '');\n\t\t}\n\n\t\tfunction modifiersEqual(e, modifiers) {\n\t\t\treturn Object.keys(MODIFIERS).reduce((modifiersCorrect, mod) => {\n\t\t\t\treturn modifiersCorrect && (e[mod] === modifiers[mod]);\n\t\t\t}, true);\n\t\t}\n\n\t\tfunction eventIsForBinding(e, binding, keyProp) {\n\t\t\t// \"e\" may be a jQuery event, we want the original Javascript event though\n\t\t\te = e.originalEvent || e;\n\n\t\t\treturn modifiersEqual(e, binding) && e[keyProp] === binding[keyProp];\n\t\t}\n\n\t\tconst IGNORED_KEYS = ['Shift', 'Alt', 'Control', 'Meta', 'F5'];\n\n\t\tfunction MouseButtonBinding(val) {\n\t\t\treturn val;\n\t\t}\n\n\t\tMouseButtonBinding._MOUSE_BUTTONS = new Proxy({\n\t\t\t0: 'LeftClick',\n\t\t\t1: 'MiddleClick',\n\t\t\t2: 'RightClick'\n\t\t}, {\n\t\t\tget(obj, prop) {\n\t\t\t\treturn prop in obj ? obj[prop] : 'Mouse' + ((+prop) + 1);\n\t\t\t}\n\t\t});\n\t\tMouseButtonBinding._eventHandlers = {\n\t\t\tmousedown(e) {\n\t\t\t\te = e.originalEvent || e;\n\t\t\t\te.preventDefault();\n\n\t\t\t\tconst $input = $(e.target);\n\t\t\t\t$input.focus();\n\t\t\t\t$input.val(MouseButtonBinding.format(e));\n\t\t\t},\n\n\t\t\tkeydown(e) {\n\t\t\t\te = e.originalEvent || e;\n\t\t\t\tif (IGNORED_KEYS.includes(e.key)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t\tif (e.key === 'Escape') {\n\t\t\t\t\tconst $input = $(e.target);\n\t\t\t\t\t$input.val('');\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tMouseButtonBinding.parse = (val) => {\n\t\t\tif (!val) return val;\n\t\t\tconst modifiers = parseModifiers(val, 'button');\n\t\t\tif (/Mouse\\d/.test(modifiers.button)) {\n\t\t\t\tmodifiers.button = +modifiers.button[5];\n\t\t\t} else {\n\t\t\t\tmodifiers.button = Object.entries(MouseButtonBinding._MOUSE_BUTTONS)\n\t\t\t\t\t.reduce((btn, [val, text]) => {\n\t\t\t\t\t\treturn btn === text ? +val : btn;\n\t\t\t\t\t}, modifiers.button);\n\t\t\t}\n\t\t\treturn modifiers;\n\t\t};\n\t\tMouseButtonBinding.format = (val) => {\n\t\t\treturn formatModifiers(val) + MouseButtonBinding._MOUSE_BUTTONS[val.button];\n\t\t};\n\t\tMouseButtonBinding.eventIsForBinding = (event, button) => {\n\t\t\treturn eventIsForBinding(event, button, 'button');\n\t\t};\n\n\t\tfunction KeyBinding(val) {\n\t\t\treturn val;\n\t\t}\n\n\t\tKeyBinding._LOCATIONS = {\n\t\t\t0: '',\n\t\t\t1: 'Left ',\n\t\t\t2: 'Right ',\n\t\t\t3: 'Numpad '\n\t\t};\n\t\tKeyBinding._eventHandlers = {\n\t\t\tkeydown(e) {\n\t\t\t\te = e.originalEvent || e;\n\n\t\t\t\tif (IGNORED_KEYS.includes(e.key)) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\te.preventDefault();\n\n\t\t\t\tconst $input = $(e.target);\n\t\t\t\tif (e.key === 'Escape') {\n\t\t\t\t\t$input.val('');\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t$input.val(KeyBinding.format(e));\n\t\t\t}\n\t\t};\n\t\tKeyBinding.parse = (val) => {\n\t\t\tif (!val) return val;\n\t\t\tconst withModifiers = parseModifiers(val, 'key');\n\n\t\t\treturn Object.entries(KeyBinding._LOCATIONS)\n\t\t\t\t.filter(entry => entry[1] !== '')\n\t\t\t\t.reduce((obj, [prop, val]) => {\n\t\t\t\t\tif (obj.key.includes(val)) {\n\t\t\t\t\t\tobj.location = prop;\n\t\t\t\t\t\tobj.key = obj.key.replace(val, '');\n\t\t\t\t\t}\n\t\t\t\t\treturn obj;\n\t\t\t\t}, {\n\t\t\t\t\t...withModifiers,\n\t\t\t\t\tlocation: 0\n\t\t\t\t});\n\t\t};\n\t\tKeyBinding.format = (val) => {\n\t\t\treturn formatModifiers(val) + KeyBinding._LOCATIONS[val.location] + val.key;\n\t\t};\n\t\tKeyBinding.eventIsForBinding = (event, button) => {\n\t\t\treturn eventIsForBinding(event, button, 'key');\n\t\t};\n\n\t\tfunction FilePickerImage(val) {\n\t\t\treturn val;\n\t\t}\n\n\t\tfunction FilePickerVideo(val) {\n\t\t\treturn val;\n\t\t}\n\n\t\tfunction FilePickerImageVideo(val) {\n\t\t\treturn val;\n\t\t}\n\n\t\tfunction FilePickerAudio(val) {\n\t\t\treturn val;\n\t\t}\n\n\t\tconst filePickers = {\n\t\t\tFilePickerImage,\n\t\t\tFilePickerVideo,\n\t\t\tFilePickerImageVideo,\n\t\t\tFilePickerAudio\n\t\t};\n\t\tFilePickerImage._init = ($html) => {\n\t\t\tconst base = 'FilePicker';\n\t\t\tconst $filePickers = $html.find(`[data-dtype^=\"${base}\"]`);\n\t\t\t$filePickers.each((idx, input) => {\n\t\t\t\tconst $input = $(input);\n\t\t\t\tconst $formGroup = $input.parent();\n\t\t\t\t$formGroup.find('.hint').css('order', '100');\n\t\t\t\tconst target = $input.attr('name');\n\t\t\t\tconst type = $input.data('dtype').substring(base.length).toLowerCase();\n\t\t\t\tconst $filePickerButton = $(`<button type=button class=file-picker title=\"Browse Files\" tabindex=-1>`\n\t\t\t\t\t+ `<i class=\"fas fa-file-import fa-fw\"></i></button>`);\n\t\t\t\t$filePickerButton.attr('data-type', type);\n\t\t\t\t$filePickerButton.attr('data-target', target);\n\t\t\t\t$input.after($filePickerButton);\n\t\t\t});\n\t\t};\n\t\tObject.values(filePickers).forEach(FilePicker => {\n\t\t\tFilePicker.parse = (val) => val;\n\t\t\tFilePicker.format = (val) => val;\n\t\t});\n\n\t\tclass DirPicker extends FilePicker {\n\t\t\tconstructor(options) {\n\t\t\t\tsuper(options);\n\n\t\t\t\tthis.extensions = [];\n\t\t\t}\n\n\t\t\tactivateListeners($html) {\n\t\t\t\tsuper.activateListeners($html);\n\t\t\t\t$html.find('.form-footer').remove();\n\t\t\t\t$html.find('.dir').each((idx, li) => {\n\t\t\t\t\tconst $li = $(li);\n\t\t\t\t\t$li.css('padding-left', 0);\n\t\t\t\t\tconst $selectButton = $('<button type=button>Select</button>');\n\t\t\t\t\t$selectButton.css('width', 'auto');\n\t\t\t\t\t$selectButton.css('margin-left', '0');\n\t\t\t\t\tthis._addOnClick($selectButton, $li.data('path'));\n\t\t\t\t\t$li.prepend($selectButton)\n\t\t\t\t});\n\n\t\t\t\t$html.find('.note').text('No subdirectories.');\n\n\t\t\t\tconst $selectCurrent = $('<button type=button>Select current directory</button>');\n\t\t\t\tthis._addOnClick($selectCurrent, $html.find('[name=target]').val());\n\t\t\t\t$html.append($selectCurrent);\n\t\t\t}\n\n\t\t\t_addOnClick($selectButton, path) {\n\t\t\t\t$selectButton.click((event) => {\n\t\t\t\t\tevent.stopPropagation();\n\t\t\t\t\t$(this.field).val(path);\n\t\t\t\t\tthis.close();\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\tfunction DirectoryPicker(val) {\n\t\t\treturn val;\n\t\t}\n\n\t\tDirectoryPicker.parse = (val) => val;\n\t\tDirectoryPicker.format = (val) => val;\n\t\tDirectoryPicker._init = ($html) => {\n\t\t\tconst $directoryPickers = $html.find(`[data-dtype=\"${DirectoryPicker.name}\"]`);\n\t\t\t$directoryPickers.each((idx, input) => {\n\t\t\t\tconst $input = $(input);\n\t\t\t\tconst $browseButton = $(`<button type=button title=\"Browse Directories\" tabindex=-1>`\n\t\t\t\t\t+ `<i class=\"fas fa-file-import fa-fw\"></i></button>`);\n\t\t\t\t$browseButton.css('flex', '0 0 24px');\n\t\t\t\t$browseButton.css('line-height', '24px');\n\t\t\t\t$browseButton.css('margin-left', '4px');\n\t\t\t\t$input.after($browseButton);\n\t\t\t\t$browseButton.click((event) => {\n\t\t\t\t\tevent.preventDefault();\n\t\t\t\t\tnew DirPicker({\n\t\t\t\t\t\tfield: $input,\n\t\t\t\t\t\tcurrent: $input.val(),\n\t\t\t\t\t\tbutton: $browseButton\n\t\t\t\t\t}).browse();\n\t\t\t\t});\n\t\t\t})\n\t\t};\n\n\n\t\treturn {\n\t\t\tMouseButtonBinding,\n\t\t\tKeyBinding,\n\t\t\t...filePickers,\n\t\t\tDirectoryPicker\n\t\t};\n\t}\n\n\tfunction isNewestVersionEnabled() {\n\t\tconst existingClass = window.Azzu.ExtendedSettingsConfig;\n\t\tif (!existingClass) return false;\n\n\t\tconst oldVersion = existingClass.settingsExtenderVersion;\n\t\tif (!oldVersion) return false;\n\n\t\tconst curVersion = SETTINGS_EXTENDER_VERSION;\n\t\treturn oldVersion.major < curVersion.major\n\t\t\t|| oldVersion.minor < curVersion.minor\n\t\t\t|| oldVersion.patch < curVersion.patch\n\t}\n\n\tfunction extendSettingsWindow() {\n\t\tHooks.once('ready', () => {\n\t\t\tif (isNewestVersionEnabled()) return;\n\n\t\t\twindow.Azzu.ExtendedSettingsConfig = ExtendedSettingsConfig;\n\t\t\tgame.settings._sheet = new ExtendedSettingsConfig(game.settings.settings);\n\t\t});\n\t}\n\n\tclass ExtendedSettingsConfig extends SettingsConfig {\n\n\t\tstatic get settingsExtenderVersion() {\n\t\t\treturn SETTINGS_EXTENDER_VERSION;\n\t\t}\n\n\t\tstatic get defaultOptions() {\n\t\t\treturn mergeObject(super.defaultOptions, {\n\t\t\t\tbaseApplication: 'SettingsConfig'\n\t\t\t});\n\t\t}\n\n\t\tgetData() {\n\t\t\tconst data = super.getData();\n\t\t\tconst modules = Compatibility.getSettingsConfigModules(data);\n\t\t\tmodules.flatMap(m => m.settings).forEach(setting => {\n\t\t\t\tconst key = setting.module + '.' + setting.key;\n\t\t\t\tconst type = Compatibility.getGameSettting(key).type;\n\t\t\t\tif (typeof type === 'function') {\n\t\t\t\t\tsetting.type = type.name;\n\t\t\t\t} else {\n\t\t\t\t\tsetting.type = 'unknown'\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn data;\n\t\t}\n\n\t\tactivateListeners($html) {\n\t\t\tlet extraTypes = window.Azzu.SettingsTypes;\n\t\t\t// before super.activateListeners as FormApplication.activateListeners\n\t\t\t// initialises FilePickers\n\t\t\tObject.values(extraTypes).forEach(type => type._init && type._init($html));\n\n\t\t\tsuper.activateListeners($html);\n\n\t\t\tObject.entries(extraTypes).forEach(([name, type]) => {\n\t\t\t\tif (!type._eventHandlers) return;\n\t\t\t\tconst $inputs = $html.find(`[data-dtype=\"${name}\"`);\n\t\t\t\tObject.entries(type._eventHandlers).forEach(([eventType, handler]) => {\n\t\t\t\t\t$inputs.on(eventType, handler);\n\t\t\t\t});\n\t\t\t});\n\t\t}\n\t}\n}\n"],"sourceRoot":""}