{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/scripts/index.js","webpack:///./src/scripts/layer-hotkeys.js","webpack:///./src/scripts/settings-extender.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Hooks","once","async","CONFIG","layer","tool","DEFAULT_KEYS","maxNumTools","control","ui","controls","visible","game","settings","register","title","hint","i18n","localize","scope","config","default","type","window","Azzu","SettingsTypes","KeyBinding","onChange","Math","max","tools","length","toString","on","app","html","data","find","ev","render","addEventListener","repeat","document","activeElement","tagName","canvas","activeLayer","controlled","parse","eventIsForBinding","preventDefault","stopPropagation","getLayer","activate","activeControl","e","filter","activateTool","ctrlKey","activeTool","preview","children","wall","wall_data","_getWallDataFromActiveTool","scene_control","layerKeys","undefined","entries","toolKeys","li","getAttribute","toUpperCase","ctrls","getElementsByClassName","j","SETTINGS_EXTENDER_VERSION","major","minor","patch","MODIFIERS","shiftKey","metaKey","altKey","parseModifiers","val","keyProp","reduce","obj","prop","includes","replace","formatModifiers","modifier","mod","str","binding","modifiers","keys","modifiersCorrect","modifiersEqual","originalEvent","IGNORED_KEYS","MouseButtonBinding","FilePickerImage","_MOUSE_BUTTONS","Proxy","0","1","2","_eventHandlers","$input","$","target","focus","format","test","button","btn","text","event","_LOCATIONS","3","withModifiers","entry","location","filePickers","FilePickerVideo","FilePickerImageVideo","FilePickerAudio","_init","$html","each","idx","input","parent","css","attr","substring","toLowerCase","$filePickerButton","after","values","forEach","FilePicker","DirPicker","options","super","this","extensions","activateListeners","remove","$li","$selectButton","_addOnClick","prepend","$selectCurrent","append","path","click","field","close","DirectoryPicker","$browseButton","current","browse","createExtraInputTypes","registerSettingsTypes","existingClass","ExtendedSettingsConfig","oldVersion","settingsExtenderVersion","curVersion","isNewestVersionEnabled","_sheet","Compatibility","below_0_5_3","between_0_5_3_and_0_6_0","Map","SettingsConfig","mergeObject","defaultOptions","baseApplication","getData","getSettingsConfigModules","flatMap","setting","getGameSettting","extraTypes","$inputs","eventType","handler"],"mappings":"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","file":"index.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"modules/layer-hotkeys/scripts/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/scripts/index.js\");\n","import Init from './layer-hotkeys.js';\r\nimport settingsExtender from './settings-extender.js';\r\n\r\nsettingsExtender();\r\nInit();","export default function() {\r\n    Hooks.once('ready', async () => {\r\n        CONFIG[\"layer-hotkeys\"] = {\r\n            layer: {},\r\n            tool: {}\r\n        };\r\n        const DEFAULT_KEYS = {\r\n            \"token\": \"t\",\r\n            \"measure\": \"m\",\r\n            \"tiles\": \"i\",\r\n            \"drawings\": \"d\",\r\n            \"walls\": \"w\",\r\n            \"lighting\": \"l\",\r\n            \"sounds\": \"s\",\r\n            \"notes\": \"n\"\r\n        }\r\n\r\n        let maxNumTools = 0;\r\n        for(let control of ui.controls.controls) {\r\n            // Skip controls  that aren't accessible for the user\r\n            if (control.visible == false)\r\n                continue;\r\n        \r\n            game.settings.register(\"layer-hotkeys\", \"control-\" + control.name, {\r\n                name: control.title,\r\n                hint: game.i18n.localize(\"LAYER-HOTKEYS.ControlsHint\") + \" \" + game.i18n.localize(control.title),\r\n                scope: \"user\",\r\n                config: true,\r\n                default: DEFAULT_KEYS[control.name] || null,\r\n                type: window.Azzu.SettingsTypes.KeyBinding,\r\n                onChange: key => {\r\n                    CONFIG[\"layer-hotkeys\"].layer[control.name] = key;\r\n                }\r\n            })\r\n            CONFIG[\"layer-hotkeys\"].layer[control.name] = game.settings.get(\"layer-hotkeys\", \"control-\" + control.name);\r\n            maxNumTools = Math.max(control.tools.length, maxNumTools);\r\n        }\r\n\r\n        for (let i = 1; i <= maxNumTools; i++) {\r\n            game.settings.register(\"layer-hotkeys\", \"tool-\" + i, {\r\n                name: game.i18n.localize(\"LAYER-HOTKEYS.ToolName\") + \" \" + i,\r\n                hint: game.i18n.localize(\"LAYER-HOTKEYS.ToolsHint\") + \" \" + game.i18n.localize(\"LAYER-HOTKEYS.ToolName\") + \" \" + i,\r\n                scope: \"user\",\r\n                config: true,\r\n                default: (i%10).toString() || \"0\",\r\n                type: window.Azzu.SettingsTypes.KeyBinding,\r\n                onChange: key => {\r\n                    CONFIG[\"layer-hotkeys\"].tool[i] = key;\r\n                }\r\n            })\r\n            CONFIG[\"layer-hotkeys\"].tool[i] = game.settings.get(\"layer-hotkeys\", \"tool-\" + i);\r\n        }\r\n        \r\n    })\r\n\r\n    Hooks.on('renderExtendedSettingsConfig', (app, html, data)=> {\r\n        // Force rerender of controls on submitting settings, so the titles get updated\r\n        html.find('button:submit').on('click', ev => ui.controls.render())\r\n    })\r\n\r\n\r\n\r\n    Hooks.once('ready', () => {\r\n        window.addEventListener('keydown', ev => {\r\n            if (ev.repeat)\r\n                return true;\r\n\r\n            if (document.activeElement.tagName !== 'BODY' ||  canvas.activeLayer.controlled.length)\r\n                return true;\r\n\r\n            for (let control of ui.controls.controls) {\r\n                // Skip controls  that aren't accessible for the user\r\n                if (control.visible == false)\r\n                    continue;\r\n\r\n                const key = window.Azzu.SettingsTypes.KeyBinding.parse(CONFIG[\"layer-hotkeys\"].layer[control.name]);\r\n                if (window.Azzu.SettingsTypes.KeyBinding.eventIsForBinding(ev, key)) {\r\n                    ev.preventDefault();\r\n                    ev.stopPropagation();\r\n                    canvas.getLayer(control.layer).activate()\r\n                    return false;\r\n                }\r\n            }\r\n\r\n            const activeControl = ui.controls.controls.find(e => e.name === ui.controls.activeControl);\r\n            const tools = activeControl.tools.filter(e => e.visible !== false) || [];\r\n            for (let i = 0; i < tools.length; i++) {\r\n                const key = window.Azzu.SettingsTypes.KeyBinding.parse(CONFIG[\"layer-hotkeys\"].tool[i+1]); \r\n                let activateTool = window.Azzu.SettingsTypes.KeyBinding.eventIsForBinding(ev, key);\r\n                //extra check for wall chaining\r\n                if (activeControl.name === 'walls') {\r\n                    key.ctrlKey = true;\r\n                    activateTool = activateTool || window.Azzu.SettingsTypes.KeyBinding.eventIsForBinding(ev, key);\r\n                }\r\n\r\n                if (activateTool) {\r\n                    ev.preventDefault();\r\n                    ev.stopPropagation();\r\n                    activeControl.activeTool = tools[i].name\r\n                    ui.controls.render();\r\n                    // Change preview color for walls when chaining walls\r\n                    if (activeControl.name === 'walls') {\r\n                        let layer = canvas.activeLayer;\r\n                        if (layer.preview.children[0]) {\r\n                            let wall = layer.preview.children[0];\r\n                            const wall_data = layer._getWallDataFromActiveTool(game.activeTool);\r\n                            let data = wall.data;\r\n                            wall_data.c = data.c;\r\n                            wall.data = wall_data;\r\n                        }\r\n                    }\r\n\r\n                    return false;\r\n                }\r\n            }\r\n            return true;\r\n        })\r\n    })\r\n\r\n    Hooks.on('renderSceneControls', (app, html, data) => {\r\n        let scene_control = html.children('li.scene-control');\r\n        let layerKeys = {};\r\n        let config = CONFIG[\"layer-hotkeys\"];\r\n        if (config === undefined) return;\r\n\r\n        for (let [key, value] of Object.entries(config.layer))\r\n            layerKeys[value] = key;\r\n        let toolKeys = {};\r\n        for (let [key, value] of Object.entries(config.tool))\r\n            toolKeys[value] = key;\r\n\r\n        for (let i = 0; i < scene_control.length; i++) {\r\n            const li = scene_control[i];\r\n            let title = li.getAttribute(\"title\");\r\n            let key = config.layer[li.getAttribute(\"data-control\")];\r\n            if (key !== undefined)\r\n                li.title += \" [\" + key.toUpperCase() + \"]\";\r\n            let ctrls = li.getElementsByClassName('control-tool');\r\n            for (let j = 0; j < ctrls.length; j++) {\r\n                let title = ctrls[j].title + \" [\" + config.tool[j+1] + \"]\";\r\n                ctrls[j].title = title;\r\n            }\r\n        }\r\n    })\r\n}","/**\r\n * window.Azzu.SettingsTypes is guaranteed to be initialized on document.ready\r\n * window.Azzu.ExtendedSettingsConfig is guaranteed to be initialized after Hooks->ready\r\n */\r\nexport default function () {\r\n\tconst SETTINGS_EXTENDER_VERSION = {\r\n\t\tmajor: 1,\r\n\t\tminor: 1,\r\n\t\tpatch: 3\r\n\t};\r\n\r\n\twindow.Azzu = window.Azzu || {};\r\n\tregisterSettingsTypes();\r\n\textendSettingsWindow();\r\n\r\n\t// Definitions\r\n\r\n\t/**\r\n\t * Collection of utility methods whose only purpose it is to maintain backwards compatibility.\r\n\t */\r\n\tclass Compatibility {\r\n\r\n\t\t/**\r\n\t\t * Compatibility for getting the modules list from SettingsConfig\r\n\t\t *\r\n\t\t * @param data SettingsConfig.getData() object\r\n\t\t * @returns data.settings.modules or data.modules\r\n\t\t */\r\n\t\tstatic getSettingsConfigModules(data) {\r\n\t\t\tconst below_0_5_3 = data.settings && data.settings.modules;\r\n\t\t\tconst between_0_5_3_and_0_6_0 = data.modules;\r\n\t\t\tconst above_0_6_1 = data.data && data.data.modules;\r\n\t\t\treturn above_0_6_1 || between_0_5_3_and_0_6_0 || below_0_5_3;\r\n\t\t}\r\n\r\n\t\t/**\r\n\t\t * Compatibility for <0.5.3\r\n\t\t *\r\n\t\t * @param key the key of the game setting\r\n\t\t * @returns the game setting object\r\n\t\t */\r\n\t\tstatic getGameSettting(key) {\r\n\t\t\tconst settings = game.settings.settings;\r\n\t\t\tif (settings instanceof Map) {\r\n\t\t\t\treturn settings.get(key);\r\n\t\t\t} else {\r\n\t\t\t\treturn settings[key];\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfunction registerSettingsTypes() {\r\n\t\tif (window.Azzu.SettingsTypes) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\twindow.Azzu.SettingsTypes = createExtraInputTypes();\r\n\t}\r\n\r\n\tfunction createExtraInputTypes() {\r\n\t\tconst MODIFIERS = {\r\n\t\t\tctrlKey: 'Ctrl + ',\r\n\t\t\tshiftKey: 'Shift + ',\r\n\t\t\tmetaKey: 'Meta + ',\r\n\t\t\taltKey: 'Alt + '\r\n\t\t};\r\n\r\n\t\tfunction parseModifiers(val, keyProp) {\r\n\t\t\treturn Object.entries(MODIFIERS).reduce((obj, [prop, val]) => {\r\n\t\t\t\tif (obj[keyProp].includes(val)) {\r\n\t\t\t\t\tobj[prop] = true;\r\n\t\t\t\t\tobj[keyProp] = obj[keyProp].replace(val, '');\r\n\t\t\t\t} else {\r\n\t\t\t\t\tobj[prop] = false;\r\n\t\t\t\t}\r\n\t\t\t\treturn obj;\r\n\t\t\t}, {[keyProp]: val});\r\n\t\t}\r\n\r\n\t\tfunction formatModifiers(val) {\r\n\t\t\treturn Object.entries(MODIFIERS)\r\n\t\t\t\t.reduce((modifier, [mod, str]) => {\r\n\t\t\t\t\treturn modifier + (val[mod] ? str : '');\r\n\t\t\t\t}, '');\r\n\t\t}\r\n\r\n\t\tfunction modifiersEqual(e, modifiers) {\r\n\t\t\treturn Object.keys(MODIFIERS).reduce((modifiersCorrect, mod) => {\r\n\t\t\t\treturn modifiersCorrect && (e[mod] === modifiers[mod]);\r\n\t\t\t}, true);\r\n\t\t}\r\n\r\n\t\tfunction eventIsForBinding(e, binding, keyProp) {\r\n\t\t\t// \"e\" may be a jQuery event, we want the original Javascript event though\r\n\t\t\te = e.originalEvent || e;\r\n\r\n\t\t\treturn modifiersEqual(e, binding) && e[keyProp] === binding[keyProp];\r\n\t\t}\r\n\r\n\t\tconst IGNORED_KEYS = ['Shift', 'Alt', 'Control', 'Meta', 'F5'];\r\n\r\n\t\tfunction MouseButtonBinding(val) {\r\n\t\t\treturn val;\r\n\t\t}\r\n\r\n\t\tMouseButtonBinding._MOUSE_BUTTONS = new Proxy({\r\n\t\t\t0: 'LeftClick',\r\n\t\t\t1: 'MiddleClick',\r\n\t\t\t2: 'RightClick'\r\n\t\t}, {\r\n\t\t\tget(obj, prop) {\r\n\t\t\t\treturn prop in obj ? obj[prop] : 'Mouse' + ((+prop) + 1);\r\n\t\t\t}\r\n\t\t});\r\n\t\tMouseButtonBinding._eventHandlers = {\r\n\t\t\tmousedown(e) {\r\n\t\t\t\te = e.originalEvent || e;\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tconst $input = $(e.target);\r\n\t\t\t\t$input.focus();\r\n\t\t\t\t$input.val(MouseButtonBinding.format(e));\r\n\t\t\t},\r\n\r\n\t\t\tkeydown(e) {\r\n\t\t\t\te = e.originalEvent || e;\r\n\t\t\t\tif (IGNORED_KEYS.includes(e.key)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\te.preventDefault();\r\n\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\tconst $input = $(e.target);\r\n\t\t\t\t\t$input.val('');\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t};\r\n\t\tMouseButtonBinding.parse = (val) => {\r\n\t\t\tif (!val) return val;\r\n\t\t\tconst modifiers = parseModifiers(val, 'button');\r\n\t\t\tif (/Mouse\\d/.test(modifiers.button)) {\r\n\t\t\t\tmodifiers.button = +modifiers.button[5];\r\n\t\t\t} else {\r\n\t\t\t\tmodifiers.button = Object.entries(MouseButtonBinding._MOUSE_BUTTONS)\r\n\t\t\t\t\t.reduce((btn, [val, text]) => {\r\n\t\t\t\t\t\treturn btn === text ? +val : btn;\r\n\t\t\t\t\t}, modifiers.button);\r\n\t\t\t}\r\n\t\t\treturn modifiers;\r\n\t\t};\r\n\t\tMouseButtonBinding.format = (val) => {\r\n\t\t\treturn formatModifiers(val) + MouseButtonBinding._MOUSE_BUTTONS[val.button];\r\n\t\t};\r\n\t\tMouseButtonBinding.eventIsForBinding = (event, button) => {\r\n\t\t\treturn eventIsForBinding(event, button, 'button');\r\n\t\t};\r\n\r\n\t\tfunction KeyBinding(val) {\r\n\t\t\treturn val;\r\n\t\t}\r\n\r\n\t\tKeyBinding._LOCATIONS = {\r\n\t\t\t0: '',\r\n\t\t\t1: 'Left ',\r\n\t\t\t2: 'Right ',\r\n\t\t\t3: 'Numpad '\r\n\t\t};\r\n\t\tKeyBinding._eventHandlers = {\r\n\t\t\tkeydown(e) {\r\n\t\t\t\te = e.originalEvent || e;\r\n\r\n\t\t\t\tif (IGNORED_KEYS.includes(e.key)) {\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\tconst $input = $(e.target);\r\n\t\t\t\tif (e.key === 'Escape') {\r\n\t\t\t\t\t$input.val('');\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n\t\t\t\t$input.val(KeyBinding.format(e));\r\n\t\t\t}\r\n\t\t};\r\n\t\tKeyBinding.parse = (val) => {\r\n\t\t\tif (!val) return val;\r\n\t\t\tconst withModifiers = parseModifiers(val, 'key');\r\n\r\n\t\t\treturn Object.entries(KeyBinding._LOCATIONS)\r\n\t\t\t\t.filter(entry => entry[1] !== '')\r\n\t\t\t\t.reduce((obj, [prop, val]) => {\r\n\t\t\t\t\tif (obj.key.includes(val)) {\r\n\t\t\t\t\t\tobj.location = prop;\r\n\t\t\t\t\t\tobj.key = obj.key.replace(val, '');\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn obj;\r\n\t\t\t\t}, {\r\n\t\t\t\t\t...withModifiers,\r\n\t\t\t\t\tlocation: 0\r\n\t\t\t\t});\r\n\t\t};\r\n\t\tKeyBinding.format = (val) => {\r\n\t\t\treturn formatModifiers(val) + KeyBinding._LOCATIONS[val.location] + val.key;\r\n\t\t};\r\n\t\tKeyBinding.eventIsForBinding = (event, button) => {\r\n\t\t\treturn eventIsForBinding(event, button, 'key');\r\n\t\t};\r\n\r\n\t\tfunction FilePickerImage(val) {\r\n\t\t\treturn val;\r\n\t\t}\r\n\r\n\t\tfunction FilePickerVideo(val) {\r\n\t\t\treturn val;\r\n\t\t}\r\n\r\n\t\tfunction FilePickerImageVideo(val) {\r\n\t\t\treturn val;\r\n\t\t}\r\n\r\n\t\tfunction FilePickerAudio(val) {\r\n\t\t\treturn val;\r\n\t\t}\r\n\r\n\t\tconst filePickers = {\r\n\t\t\tFilePickerImage,\r\n\t\t\tFilePickerVideo,\r\n\t\t\tFilePickerImageVideo,\r\n\t\t\tFilePickerAudio\r\n\t\t};\r\n\t\tFilePickerImage._init = ($html) => {\r\n\t\t\tconst base = 'FilePicker';\r\n\t\t\tconst $filePickers = $html.find(`[data-dtype^=\"${base}\"]`);\r\n\t\t\t$filePickers.each((idx, input) => {\r\n\t\t\t\tconst $input = $(input);\r\n\t\t\t\tconst $formGroup = $input.parent();\r\n\t\t\t\t$formGroup.find('.hint').css('order', '100');\r\n\t\t\t\tconst target = $input.attr('name');\r\n\t\t\t\tconst type = $input.data('dtype').substring(base.length).toLowerCase();\r\n\t\t\t\tconst $filePickerButton = $(`<button type=button class=file-picker title=\"Browse Files\" tabindex=-1>`\r\n\t\t\t\t\t+ `<i class=\"fas fa-file-import fa-fw\"></i></button>`);\r\n\t\t\t\t$filePickerButton.attr('data-type', type);\r\n\t\t\t\t$filePickerButton.attr('data-target', target);\r\n\t\t\t\t$input.after($filePickerButton);\r\n\t\t\t});\r\n\t\t};\r\n\t\tObject.values(filePickers).forEach(FilePicker => {\r\n\t\t\tFilePicker.parse = (val) => val;\r\n\t\t\tFilePicker.format = (val) => val;\r\n\t\t});\r\n\r\n\t\tclass DirPicker extends FilePicker {\r\n\t\t\tconstructor(options) {\r\n\t\t\t\tsuper(options);\r\n\r\n\t\t\t\tthis.extensions = [];\r\n\t\t\t}\r\n\r\n\t\t\tactivateListeners($html) {\r\n\t\t\t\tsuper.activateListeners($html);\r\n\t\t\t\t$html.find('.form-footer').remove();\r\n\t\t\t\t$html.find('.dir').each((idx, li) => {\r\n\t\t\t\t\tconst $li = $(li);\r\n\t\t\t\t\t$li.css('padding-left', 0);\r\n\t\t\t\t\tconst $selectButton = $('<button type=button>Select</button>');\r\n\t\t\t\t\t$selectButton.css('width', 'auto');\r\n\t\t\t\t\t$selectButton.css('margin-left', '0');\r\n\t\t\t\t\tthis._addOnClick($selectButton, $li.data('path'));\r\n\t\t\t\t\t$li.prepend($selectButton)\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$html.find('.note').text('No subdirectories.');\r\n\r\n\t\t\t\tconst $selectCurrent = $('<button type=button>Select current directory</button>');\r\n\t\t\t\tthis._addOnClick($selectCurrent, $html.find('[name=target]').val());\r\n\t\t\t\t$html.append($selectCurrent);\r\n\t\t\t}\r\n\r\n\t\t\t_addOnClick($selectButton, path) {\r\n\t\t\t\t$selectButton.click((event) => {\r\n\t\t\t\t\tevent.stopPropagation();\r\n\t\t\t\t\t$(this.field).val(path);\r\n\t\t\t\t\tthis.close();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfunction DirectoryPicker(val) {\r\n\t\t\treturn val;\r\n\t\t}\r\n\r\n\t\tDirectoryPicker.parse = (val) => val;\r\n\t\tDirectoryPicker.format = (val) => val;\r\n\t\tDirectoryPicker._init = ($html) => {\r\n\t\t\tconst $directoryPickers = $html.find(`[data-dtype=\"${DirectoryPicker.name}\"]`);\r\n\t\t\t$directoryPickers.each((idx, input) => {\r\n\t\t\t\tconst $input = $(input);\r\n\t\t\t\tconst $browseButton = $(`<button type=button title=\"Browse Directories\" tabindex=-1>`\r\n\t\t\t\t\t+ `<i class=\"fas fa-file-import fa-fw\"></i></button>`);\r\n\t\t\t\t$browseButton.css('flex', '0 0 24px');\r\n\t\t\t\t$browseButton.css('line-height', '24px');\r\n\t\t\t\t$browseButton.css('margin-left', '4px');\r\n\t\t\t\t$input.after($browseButton);\r\n\t\t\t\t$browseButton.click((event) => {\r\n\t\t\t\t\tevent.preventDefault();\r\n\t\t\t\t\tnew DirPicker({\r\n\t\t\t\t\t\tfield: $input,\r\n\t\t\t\t\t\tcurrent: $input.val(),\r\n\t\t\t\t\t\tbutton: $browseButton\r\n\t\t\t\t\t}).browse();\r\n\t\t\t\t});\r\n\t\t\t})\r\n\t\t};\r\n\r\n\r\n\t\treturn {\r\n\t\t\tMouseButtonBinding,\r\n\t\t\tKeyBinding,\r\n\t\t\t...filePickers,\r\n\t\t\tDirectoryPicker\r\n\t\t};\r\n\t}\r\n\r\n\tfunction isNewestVersionEnabled() {\r\n\t\tconst existingClass = window.Azzu.ExtendedSettingsConfig;\r\n\t\tif (!existingClass) return false;\r\n\r\n\t\tconst oldVersion = existingClass.settingsExtenderVersion;\r\n\t\tif (!oldVersion) return false;\r\n\r\n\t\tconst curVersion = SETTINGS_EXTENDER_VERSION;\r\n\t\treturn oldVersion.major < curVersion.major\r\n\t\t\t|| oldVersion.minor < curVersion.minor\r\n\t\t\t|| oldVersion.patch < curVersion.patch\r\n\t}\r\n\r\n\tfunction extendSettingsWindow() {\r\n\t\tHooks.once('ready', () => {\r\n\t\t\tif (isNewestVersionEnabled()) return;\r\n\r\n\t\t\twindow.Azzu.ExtendedSettingsConfig = ExtendedSettingsConfig;\r\n\t\t\tgame.settings._sheet = new ExtendedSettingsConfig(game.settings.settings);\r\n\t\t});\r\n\t}\r\n\r\n\tclass ExtendedSettingsConfig extends SettingsConfig {\r\n\r\n\t\tstatic get settingsExtenderVersion() {\r\n\t\t\treturn SETTINGS_EXTENDER_VERSION;\r\n\t\t}\r\n\r\n\t\tstatic get defaultOptions() {\r\n\t\t\treturn mergeObject(super.defaultOptions, {\r\n\t\t\t\tbaseApplication: 'SettingsConfig'\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tgetData() {\r\n\t\t\tconst data = super.getData();\r\n\t\t\tconst modules = Compatibility.getSettingsConfigModules(data);\r\n\t\t\tmodules.flatMap(m => m.settings).forEach(setting => {\r\n\t\t\t\tconst key = setting.module + '.' + setting.key;\r\n\t\t\t\tconst type = Compatibility.getGameSettting(key).type;\r\n\t\t\t\tif (typeof type === 'function') {\r\n\t\t\t\t\tsetting.type = type.name;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsetting.type = 'unknown'\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\treturn data;\r\n\t\t}\r\n\r\n\t\tactivateListeners($html) {\r\n\t\t\tlet extraTypes = window.Azzu.SettingsTypes;\r\n\t\t\t// before super.activateListeners as FormApplication.activateListeners\r\n\t\t\t// initialises FilePickers\r\n\t\t\tObject.values(extraTypes).forEach(type => type._init && type._init($html));\r\n\r\n\t\t\tsuper.activateListeners($html);\r\n\r\n\t\t\tObject.entries(extraTypes).forEach(([name, type]) => {\r\n\t\t\t\tif (!type._eventHandlers) return;\r\n\t\t\t\tconst $inputs = $html.find(`[data-dtype=\"${name}\"`);\r\n\t\t\t\tObject.entries(type._eventHandlers).forEach(([eventType, handler]) => {\r\n\t\t\t\t\t$inputs.on(eventType, handler);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n}\r\n"],"sourceRoot":""}